<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TAK</title>
    <link rel="stylesheet" href="tak.css">
</head>
<body>
<div class="wrapper">
    <div class="timer-text text-color">
        <span >Timer</span>
    </div>
    <p class="claw"></p>
    <p class="claw"></p>
    <p class="claw"></p>
    <p class="claw"></p>
    <div class="timer-wrap">
            <div class="div-input">
                <label for="hour-value" class="label-color">Hours:</label>
                <input type="number" id="hour-value" max="99" maxlength="2" placeholder="00h">

                <label for="min-value" class="label-color">Minutes:</label>
                <input type="number" id="min-value" max="60" maxlength="2" placeholder="00m">

                <label for="sec-value" class="label-color">Seconds:</label>
                <input type="number" id="sec-value" max="60" maxlength="2" placeholder="00s">
            </div>

            <div class="wrap-button">
                <button type="submit" id="submit-button"><img src="start.png"></button>
                <button type="reset" id="reset-button"><img src="restart.png"></button>
            </div>
    </div>
    <div id="timer-container" class="time-object"></div>
</div>
<script>
    const minValue = document.getElementById("min-value")
    const secValue = document.getElementById("sec-value")

    document.querySelectorAll('input[type="number"]').forEach((input)=>{
        input.oninput = () =>{
            if(input.value.length > input.maxLength) input.value = input.value.slice(0, input.maxLength)
        }
    } )
    minValue.oninput = ()=>{
        if(minValue.value.length > minValue.maxLength) minValue.value = 60
    }
    secValue.oninput = ()=>{
        if(secValue.value.length > secValue.maxLength) secValue.value = 60
    }
</script>
<script>

    const submit = document.getElementById("submit-button"),
        reset = document.getElementById("reset-button");
    submit.addEventListener('click', ()=>{
        timerCreateProcessing()
    })
    reset.addEventListener('click', ()=>{
        timerCreateProcessing(true)
    })

    class Timer{
        constructor(hourValue = 0, minutValue = 0, secValue = 0, p) {
            this.h = hourValue;
            this.m = minutValue;
            this.s = secValue;
            this.p = p;
        }
        process(){
            this.showTime()
            this.timer()
            if(this.h === 0 && this.m === 0  && this.s === 0){
                return true;
            }
        }
        timer(){
            if(this.s >= 1){
                this.s -= 1
                return;
            }
            if(this.m >= 1){
                this.m -= 1
                this.s = 59
                return;
            }
            if(this.h >= 1){
                this.h -= 1
                this.m = 60
                return;
            }
        }
        showTime(){
            this.p.textContent = prefixNum(this.h) + ":" + prefixNum(this.m) + ":" + prefixNum(this.s)
        }
    }
    const prefixNum = (numb)=>{
        return numb < 10 ? "0" + numb : numb
    }
    const removeTimer =(element, interval, timerObject)=>{
        element.remove()
        timerObject = null
        clearInterval(interval)
        return;
    }
    const timerCreateProcessing = (remove=0)=>{
        if(remove){
            
        }
        const hourValue = document.getElementById("hour-value").value,
            minutValue = document.getElementById("min-value").value,
            secValue = document.getElementById("sec-value").value,
            div = document.getElementById("timer-container");

        let divTimer = document.createElement("div")
        let timer = new Timer(+hourValue, +minutValue, +secValue, divTimer)
        let interval = setInterval(()=> {
            if(timer.process()){
                setTimeout(()=>{removeTimer(divTimer, interval, timer)
                },5000)
                return
            }
        }, 1000)
        div.insertAdjacentElement('beforeend', divTimer)
    }
</script>
</body>
</html>